# LLM-based Resource-Oriented Intention Inference for Static Resource Detection

**Authors**: Wang, Chong and Liu, Jianan and Peng, Xin and Liu, Yang and Lou, Yiling

**Abstract**:

Resource leaks, caused by resources not being released after acquisition, often lead to performance issues and system crashes. Existing static detection techniques rely on mechanical matching of predefined resource acquisition/release APIs and null-checking conditions to find unreleased resources, suffering from both (1) false negatives caused by the incompleteness of predefined resource acquisition/release APIs and (2) false positives caused by the unsoundness of resource reachability validation analysis. To overcome these challenges, we propose InferROI, a novel approach that leverages the exceptional code comprehension capability of large language models (LLMs) to directly infer resource-oriented intentions (acquisition, release, and reachability validation) in code. InferROI first prompts the LLM to infer involved intentions for a given code snippet, and then incorporates a two-stage static analysis approach to check control-flow paths for resource leak detection based on the inferred intentions.We evaluate the effectiveness of InferROI in both resource-oriented intention inference and resource leak detection. Experimental results demonstrate that InferROI achieves a precision of 74.6% and a recall of 81.8% when inferring resource-oriented intentions for 172 code snippets from the DroidLeaks dataset. Additionally, InferROI covers a significant portion (i.e., 67.9% ) of concerned Android resources listed in the dataset. When applied to 86 bugs from the DroidLeaks dataset, InferROI exhibits both a high bug detection rate (53.5%) and a low false alarm rate (8.1%) compared to eight baseline detectors. Moreover, we apply InferROI to resource leak detection in 100 methods from real-world open-source projects, where InferROI identifies 12 unknown resource leak bugs, with 7 of them being confirmed by developers. Overall, this work demonstrates the promising potential of LLMs in resource leak detection.

**Link**: [Read Paper](https://arxiv.org/abs/2311.04448)

**Labels**: [static analysis](../../labels/static_analysis.md), [bug detection](../../labels/bug_detection.md)
